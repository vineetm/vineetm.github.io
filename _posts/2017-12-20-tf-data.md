---
layout: post
title: Text data in tensorflow
tags: tensorflow tf tf.data TextLineDataset
---
A powerful feature that is [now part of core API](https://github.com/tensorflow/tensorflow/blob/master/RELEASE.md) in tensorflow is [dataset API](https://www.tensorflow.org/programmers_guide/datasets).

Why should you care about dataset API? Going forward, it seems dataset API would be the [recommended way](https://www.tensorflow.org/api_guides/python/threading_and_queues) to feed data to your tensorflow model.

In this post, we will look at `tf.data` in detail from the perspective of handling **text** data.

Surprisingly, I found sparse and unclear documentation on how to use dataset API for text. I have picked this up from [NMT](https://github.com/tensorflow/nmt) blog and [code](https://github.com/tensorflow/nmt/blob/master/nmt/utils/iterator_utils.py), and experimenting using the good old jupyter notebook. I hope this blog post, helps you leverage this powerful framework for any text experiments you do using tensorflow.

OK, so lets start ...

#### Download and explore data
* Download the english sentences `train.en` and vocab `vocab.en` from [Ted Talks dataset IWSLT'15 English-Vietnamese data.](https://nlp.stanford.edu/projects/nmt/)
  ```
  wget https://nlp.stanford.edu/projects/nmt/data/iwslt15.en-vi/train.en
  wget https://nlp.stanford.edu/projects/nmt/data/iwslt15.en-vi/vocab.en
  ```

* Check the number of lines and make sure you see same output as indicated below
  ```
  wc -l *.en

  133317 train.en
  17191 vocab.en
  ```
* Take a look at the first two lines of `train.en`. You would notice that each line contains a single sentence. Further, each sentence seems tokenized.

  ```
  head -2 train.en

  Rachel Pike : The science behind a climate headline
  In 4 minutes , atmospheric chemist Rachel Pike provides a glimpse of the massive scientific effort behind the bold headlines on climate change , with her team -- one of thousands who contributed -- taking a risky flight over the rainforest in pursuit of data on a key molecule .
  ```

* Now, take a look at first 10 lines of `vocab.en`. You would notice that each line contains one word.
  ```
  head vocab.en

  <unk>
  <s>
  </s>
  Rachel
  :
  The
  science
  behind
  a
  climate
  ```
